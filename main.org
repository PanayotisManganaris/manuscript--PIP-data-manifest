#+options: ':nil *:t -:t ::t <:t H:3 \n:nil ^:t arch:headline
#+options: author:nil broken-links:nil c:nil creator:nil
#+options: d:(not "LOGBOOK") date:t e:t email:nil f:t inline:t num:nil
#+options: p:nil pri:nil prop:nil stat:t tags:t tasks:("TODO" "DONE" "NEXT") tex:t
#+options: timestamp:t title:nil toc:nil todo:t |:t
#+title: A High-Throughput Computational Dataset of Halide Perovskite Alloys\textsuperscript{\dag}
#+AUTHOR: Panayotis Manganaris
#+language: en
#+select_tags: export
#+exclude_tags: noexport
#+creator: Emacs 29.0.50 (Org mode 9.5.3)
#+cite_export:
#+latex_class: article
#+latex_class_options: [twoside, twocolumn, 9pt, draft]
#+latex_header: \usepackage[acronym]{glossaries}
#+latex_header_extra: \makeglossaries
#+latex_header_extra: \newglossaryentry{vasp}{name=VASP, description={Vienna Ab initio Simulation Package}}
#+latex_header_extra: \newacronym{paw}{PAW}{projector augmented wave}
#+latex_header_extra: \newacronym{gga}{GGA}{generalized gradient approximation}
#+latex_header_extra: \newacronym{pbe}{PBE}{Perdew-Burke-Ernzerhof}
#+latex_header_extra: \newacronym{hse}{HSE}{Heyd–Scuseria–Ernzerhof}
#+description:
#+keywords:
#+subtitle:
#+latex_compiler: pdflatex
#+date: \today
#+SETUPFILE: ~/org/rsc_header.org
#+INCLUDE: ./frontmatter.org

#+begin_export latex
\footnotetext{\textsuperscript{a}School of Materials Engineering, Purdue University, West Lafayette, IN 47907, USA; E-mail: amannodi@purdue.edu}
\footnotetext{\textsuperscript{\dag}Electronic Supplementary Information (ESI) available: https://www.github.com/PanayotisManganaris/REPO_TODO. See DOI: 00.0000/00000000.}
#+end_export

* DONE Introduction
:PROPERTIES:
:CUSTOM_ID: introduction
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from              [2022-06-05 Sun 18:16]
:END:
The challenge of optimizing Perovskite performance is one with many
facets. Almost every detail of a Perovskite crystal's structure and
chemistry effects its performance as a semiconductor. The size of the
unit cell effects its substrate affinity and in turn its carrier
concentrations [[cite:&jiang-2006-predic-lattic]]. The crystal's phase
effects many aspects of the electronic structure, including the band
gap and optical response. Of course, these qualities of a structure
are largely dependent on the specification, proportions and
arrangements of the constituent elements.

We report a synthetic dataset collected for 495 chemically distinct,
pseudo cubic Halide Perovskites. This dataset builds on that of 229
samples which formed the foundation of the prior work by
[[citet:&mannodi-kanakkithodi-2021-data-driven-new]]. The DFT computed
properties we collected and the levels of theory used are discussed in
ref:methodology. The relatively large size of this dataset is intended
to provide an initial sampling suitable for guiding exploration of the
alloy space. Structural information is considered constant to better
focus on obtaining physically meaningful interpretations of models
dealing only with information derived from a sample composition.

#+ATTR_LATEX: :float multicolumn :options h
#+CAPTION: \label{fig:outline} 
#+CAPTION: (a) Chemical space of ABX_3 perovskites. (b) Number of samples
#+CAPTION: representing each kind of primary alloy. (c) Detailed outline.
[[file:outline.png]]

* TODO Methodology
:PROPERTIES:
:CUSTOM_ID: methodology
:CLASS: unnumbered
:END:
** NEXT Building Perovskite Dataset
:PROPERTIES:
:CUSTOM_ID: building-perovskite-dataset
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "NEXT"       from "TODO"       [2022-06-05 Sun 22:11]
:END:
The dataset we report is based on standard cubic phase ABX_3
Perovskite structures obtained from public databases. Fourteen common
Perovskite constituents are selected to form our Halide Perovskite
composition space ref:fig:outline. Five constituents including
Methylammonium and Formamidinium cations represent the possible A-site
occupants. Six metals represent the possible B-site occupants. Three
halides represent the possible X-site occupants. In total, these
component vectors form a constrained 14 dimensional space (Figure
ref:fig:chemspace_uni) within which all Perovskite compounds
consisting of the elements in Figure ref:fig:outline (a) must exist.

Each computational run is performed using a 2x2x2 supercell, this
allows A and B site doping to be modeled in discrete 1/8^th fractions
of the total site occupancy, and it allows X site doping to be modeled
in 1/24^th fractions. At these mixing levels, it is appropriate to
call all these Perovskites alloys.

The pure (non-alloyed) possibilities are exhaustively sampled using
\(5*6*3 = 90\) Perovskites. Based on these pure Perovskite structures,
we mix candidates for A, B, and X sites systematically. The alloy
space sees combinatorial scaling and must be sparsely sampled
ref:fig:sample_map.

To create alloys, for example in B sites, we first select possible B
sites mixing elements.  Then SQS methods are applied to generate
random alloys for given mixing concentrations. Thus, we constructed
126 A-site mixing samples, 151 B-site mixing samples and 127 X-site
mixing samples. All resulting structures are optimized using a DFT
variable-cell relaxation under PBE-GGA. 299 of these same initial
structures also undergo a full HSE06 relaxation to help ensure the
validity of the PBE relaxations.

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:chemspace_uni}
#+CAPTION: Plots showing number of Perovskites representing a constituent
#+CAPTION: at a certain atomic fraction of a complete Perovskite.
[[file:variability_of_composition_vectors.png]]

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:sample_map}
#+CAPTION: Heatmaps show samples chosen to represent B-alloy space

** TODO Calculation Details
:PROPERTIES:
:CUSTOM_ID: calculation-details
:CLASS: unnumbered
:END:
Calculation DFT calculations are performed with \gls{vasp} version
6.1. \acrfull{paw} pseudopotentials were used. All calculations for
all samples are performed using the \acrfull{pbe}
functional. Additionally, \acrfull{hse} is used as
exchange-correlation energy. The energy cutoff for the plane-wave
basis is set to 500 eV. The Brillouin zone was sampled by 4x4x4
Monkhorst-Pack k-point mesh. The structural force convergence
threshold is set to be 0.5 eV/Å.

*** TODO LOPTICS Calculations and Absorption Spectrum
:PROPERTIES:
:CUSTOM_ID: loptics-calculations-and-absorption-spectrum
:CLASS: unnumbered
:END:

** TODO Discussion of DFT Computed Properties
:PROPERTIES:
:CUSTOM_ID: analysis-of-dft-computed-properties
:CLASS: unnumbered
:END:
*** DONE Decomposition Energy
:PROPERTIES:
:CUSTOM_ID: decomposition-energy
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from "TODO"       [2022-06-06 Mon 00:43]
:END:
The decomposition energy indicates the stability of a compound. To
calculate the decomposition energy for ABX3 perovskite, we assume it
will decompose to two phases, AX and BX2. Using DFT calculations, we
can get the optimized energy of a Perovskite and that of its
constituent phases. The decomposition energy is calculated using
equation eqref:eq:decoE. This calculation is performed separately for
each level of theory.

\begin{equation}\label{eq:decoE}
E_{decomp} = E_{opt}(ABX_3) - E_{opt}(AX) - E_{opt}(AX2)
\end{equation}

*** TODO Band Gap and Band Structure
:PROPERTIES:
:CUSTOM_ID: band-gap-and-band-structure
:CLASS: unnumbered
:END:

*** DONE SLME Package
:PROPERTIES:
:CUSTOM_ID: slme-package
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from              [2022-06-05 Sun 20:45]
:END:
The SLME metric developed by [[citet:&yu-2012-ident-poten]] is used as the
primary criterion screening perovskites for their photovoltaic
merits. The SLME value is computed considering a 5\mu{}m absorption layer
for every Perovskite using Logan William's SL3ME
[[cite:&williams-2022-sl3me]]. This calculation is performed separately
for the PBE band gaps and the HSE band gaps, resulting in two
synthetic efficiencies for each record.

* TODO Results and discussion
:PROPERTIES:
:CUSTOM_ID: results-and-discussion
:CLASS: unnumbered
:END:
** TODO Visualization of DFT Data
:PROPERTIES:
:CUSTOM_ID: visualization-of-dft-data
:CLASS: unnumbered
:END:
#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:pairplots} 
#+CAPTION: DFT Results: PBE and HSE properties; lattice constants,
#+CAPTION: decomposition energies, band gaps, and converter efficiencies.
[[file:Figure2.png]]

*** DONE Lattice constant PBE vs HSE
:PROPERTIES:
:CUSTOM_ID: lattice-constant-pbe-vs-hse
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from              [2022-06-06 Mon 01:02]
:END:
Fig ref:fig:lc_lot_vs presents the lattice parameter comparison of PBE
calculation and HSE calculations. Full relaxations at both levels of
theory mostly agree on the lattice parameters. At least, any deviation
appears to be very linearly explained. This suggests the accuracy of
PBE relaxation is enough to optimize most Perovskite samples.

Note this also served as a reasonable validation for our results. A
few samples did have significantly differing lattice parameters. This
prompted checking the optimized structures. We found those Perovskite
structures were substantially deformed and no longer had obvious
octahedral structures. Thus, we exclude these outliers from any
analysis concerned with the dominant pseudo cubic structures which are
the focus of this report.

#+ATTR_LATEX: :float
#+CAPTION: \label{fig:lc_lot_vs}
#+CAPTION: Comparing lattice constants obtain by full PBE and HSE
#+CAPTION: relax calculations
[[file:pbe_v_hse_LC.png]]

*** DONE Comparing synthetic to physical data
:STATUSLOG:
- State "DONE"       from              [2022-06-06 Mon 01:01]
:END:

#+ATTR_LATEX: :float 
#+CAPTION: \label{fig:lc_val_vs} 
#+CAPTION: Comparison of PBE and HSE computed pseudo-cubic lattice
#+CAPTION: constants with crystallographic measures for lattice constants
[[file:pbe_v_exp_LC.png]]
[[file:hse_v_exp_LC.png]]

The physical data used in comparison is collected from the works of
[[citet:&briones-2021-accel-lattic;&jiang-2006-predic-lattic;&chen-2015-under-spotl]].

*** TODO Decomposition energy vs band gap PBE and HSE
:PROPERTIES:
:CUSTOM_ID: decomposition-energy-vs-band-gap-pbe-and-hse
:CLASS: unnumbered
:END:
Fig 2(b) is showing the PBE band gap compared to the PBE decomposition
energy. It presents the diversity of our perovskite dataset. The data
sets cover a large range of band gap and decomposition energy. For
example, we have perovskite with low decomposition energy (good
stability) and suitable band gap value (between 1 eV to 2.5 eV for PBE
calculations). And we can also find samples with low stability and large
band gap. The distribution of band gap and decomposition energy shows a
great diversity of all perovskite samples and indicates that our data
set can statistically represent a sufficient perovskite space. Fig 2(c)
shows the plot of HSE band gaps and HSE decomposition energy. Since we
applied HSE calculations for part of the samples, it shows some grouping
on low decomposition energy. Compared to PBE plot, more data should be
added in high decomposition energy region and suitable band gap region.

*** TODO Spectroscopic Limited Maximum Efficiency (SLME) vs PBE Band gap
:PROPERTIES:
:CUSTOM_ID: spectroscopic-limited-maximum-efficiency-slme-vs-pbe-band-gap
:CLASS: unnumbered
:END:
Fig 2(d) presents the Spectroscopic Limited Maximum Efficiency (SLME)
values related to the PBE band gap. Spectroscopic Limited Maximum
Efficiency (SLME) is a very important properties for photovoltaic
performance. SLME measures the absorption efficiency of light for the
perovskite. As Fig 2(d) showing, a peak around 1.5 eV is obvious. The
peak indicates that these samples with 1.5 eV PBE band gap will also
have best absorption efficiency as photovoltaic materials. As the band
gap increases, the SLME value decreases and eventually goes to zero due
to the high band gap values.

** TODO Pearson Correlation Results
:PROPERTIES:
:CUSTOM_ID: pearson-correlation-results
:CLASS: unnumbered
:END:

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:pearson} 
#+CAPTION: Pearson linear correlation coefficients between 50 composition and
#+CAPTION: elemental descriptors and (a) 6 PBE computed properties, and (b) 4
#+CAPTION: HSE computed properties.
[[file:PBE_v_comp_pearson2.png]]
[[file:PBE_v_site_prop_pearson.png]]

It is unlikely that any of the targets is fully explained by a single
composition or composition derived axis. But there are helpful relations
that aid in obtaining a physical understanding.

as in a Pearson correlation map is produced to check for strong
relations. Those that exist, when plotted in detail show some trending,
but always with extensive variability. Evidently, an accurate model will
have to be formed on a multidimensional domain.

** TODO PCA
:PROPERTIES:
:CUSTOM_ID: pca
:CLASS: unnumbered
:END:
#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:pca}
#+CAPTION: PCA
[[file:comp_ratio_projection_annot.png]]

Principal Component Analysis is a method of projecting high dimensional
data onto a plane defined by the two linear combinations of axes that
explain as much of the variance as possible.

The method of PCA is the Singular Value Decomposition, a Unitary
Transform which generalizes the familiar eigendecomposition. PCA will
"rotate" the N data points in M-D space until their widest 2D cross
section is displayed.

At this point it is readily apparent that this dataset is highly
topological. The data exists on a mostly bounded domain in high
dimensions, so there is some geometry the features constitute.

Our models will prefer to use this this geometric structure in their
explanation for why perovskite properties vary, this can be useful for
accuracy, it can also be a bias-inducing hindrance.

** TODO t-SNE visualization of stability clustering
:PROPERTIES:
:CUSTOM_ID: mds-t-sne-isomap-results
:CLASS: unnumbered
:END:
#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:pca}
#+CAPTION: t-SNE
[[file:tsne_comp_DecoE_clusters.png]]

** DONE Screening process of all samples in database
:PROPERTIES:
:CUSTOM_ID: screening-process-of-all-samples-in-database
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from              [2022-05-24 Tue 13:31]
:END:
The synthetic Perovskite data is collected for sampling variety and
without regard for each compound's viability. In order to extract
potentially high-performing candidates for synthesis, we screen all
samples according to certain constraints, thereby obtaining some
Perovskites worth examining with higher Level of Theory DFT
calculations and future physical experiments by brute force. This
dataset can only confidently claim to sample cubic phase
perovskites. Therefore, a promising candidate should have low
deformation. Additionally, a lower decomposition energy combined with
a maximal SLME value would be ideal for physical testing. Our
screening procedure consists of cutting based on the Deviation from
Cubicity metric, octahedral factor, Goldschmidt tolerance factor,
Bartel tolerance factor, decomposition energy, and band gap -- acting
as less stringent proxy for the SLME spectrum. The following sections
will discuss the details of each constraint.

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:cuts}
#+CAPTION: placing limits on properties governing viability results in a subset
#+CAPTION: of the dataset potentially suitable for physical testing.
[[file:Figure6.png]]

*** Deviation from Cubicity
:PROPERTIES:
:CUSTOM_ID: deviation-of-cubicity
:CLASS: unnumbered
:END:
For all the compositions we tested in our data set, some of them will
have large strain and deformation because of the combination of
elements. For these largely deformed samples, they are no longer remain
a cubic perovskite structure. In this section, we want to analyst how
the structure is apart from the cubic perovskite structure and rule out
these largely deformed samples. Firstly, we need to define deviation of
cubicity. For each perovskite sample, we measure the difference between
b, c lattice parameter against a lattice, showing in Equation X. If the
lattice deviation of cubicity is larger than 10%, we will consider this
perovskite is no longer remain a cubic perovskite and exclude it.
Similarly, we also need to consider 3 angles, , and , to make sure the
angle also remain 90 degrees. We calculated the difference of , and
versus 90 degrees, showing in Equation X, and take this as angular
deviation of cubicity. We also consider the samples that have more than
5% of angular deviation of cubicity are not cubic perovskites and
exclude them. Fig 7 (d) shows the screening results for angle deviation
of cubicity. SI Fig X shows the screening results for b, c lattice and ,
angle. Most of the samples with non-cubic perovskites structures are
organic-inorganic hybrid perovskites. A large part of the excluded
samples are A-mixing hybrid perovskites. It indicates that organic
ligands in A site sometimes increase the lattice along some direction
and make the perovskite deformed.

*** Octahedral factor, tolerance factor, and Bartel tolerance factor
:PROPERTIES:
:CUSTOM_ID: octahedral-factor-tolerance-factor-and-bartel-tolerance-factor
:CLASS: unnumbered
:END:
The stability of perovskite can be predicted by using the atom radius of
all components. There are 3 types of factors are usually considered,
Octahedral factor, tolerance factor, and Bartel tolerance factor. The
formula of these three factors are shown in equation XXX. In our
screening process, we set the criteria for Octahedral factor as 0.442 --
0.895. The criteria for tolerance factor is set to be 0.813 -- 1.107.
The criteria for Bartel tolerance factor is set to be less than 4.18.
Fig 7 (a) shows the Octahedral factor versus decomposition energy plot.
Fig 7 (b) shows the tolerance factor versus decomposition energy plot.
The tolerance factor shows a trend that as the tolerance factor
increases, the decomposition energy decreases. Fig 7 (c) shows the
Bartel tolerance factor versus decomposition energy plot. Within the
criteria of Bartel tolerance factor, the decomposition energy is rapidly
decreased.

*** Screening Results
:PROPERTIES:
:CUSTOM_ID: screening-results
:CLASS: unnumbered
:END:
...\\

* Perspective and Future Work
:PROPERTIES:
:CUSTOM_ID: perspective-and-future-work
:CLASS: unnumbered
:END:
The design of this dataset is uniquely suited to the exploration of
alloying effects on Perovskite properties. The combinatorial space of
possible alloys has been sparsely but systematically sampled along
four primary alloy schemes. This sample space affords the opportunity
for a QM/ML surrogate model to form the basis of an active learning
strategy which can begin selecting potentially high performing
multi-site alloy candidates based on the current sample set.

For the calculation of future data points obtained by a surrogate
optimizer, we will follow a strategy of performing full structural
optimization at a PBE level of theory unless circumstances demand
otherwise. This is justified by ref:fig:lc_lot_vs.

Also, we will explore methods for combining the insights of the PBE
and HSE datasets in training surrogates, e.g. in section
ref:slme-package the two SLME spectra could be used together to
converge on a physically accurate PCE value.

We anticipate our principal challenge will be in extracting useful
predictor variables from the composition information. The basic
feature sets examined here are highly correlated, but nonetheless show
promise both as a basic screening criterion, and as good classifier
features under t-SNE transformation.

Modeling pipelines capable of predicting Perovskite decomposition
energy will likely be very achievable using a transductive and
invertible equivalent of the t-SNE algorithm, potentially SONG.

For this reason, kernel learning methods appear to be particularly
promising for high speed optimization of the space.

* Conclusions
:PROPERTIES:
:CUSTOM_ID: conclusions
:CLASS: unnumbered
:END:
...\\

* Conflicts of interest
:PROPERTIES:
:CUSTOM_ID: conflicts-of-interest
:CLASS: unnumbered
:END:
There are no conflicts to declare.

* acknowledgements
:PROPERTIES:
:CUSTOM_ID: acknowledgements
:CLASS: unnumbered
:END:
Extensive discussions with and scientific feedback from UC San Diego
researchers David Fenning and Rishi Kumar and Argonne National Lab
scientist Maria Chan are acknowledged. This work was performed at Purdue
University, under startup account F.10023800.05.002 from the Materials
Engineering department. This research used resources of the National
Energy Research Scientific Computing Center, the Laboratory Computing
Resource Center at Argonne National Laboratory, and the RCAC clusters at
Purdue.

bibliographystyle:rsc
bibliography:~/org/bibliotex/bibliotex.bib
* Supplemental Material
:PROPERTIES:
:CUSTOM_ID: SI
:CLASS: unnumbered
:END:
[[file:HSE_v_comp_pearson2.png]]
[[file:HSE_v_site_prop_pearson.png]]

