#+options: ':nil *:t -:t ::t <:t H:3 \n:nil ^:t arch:headline
#+options: author:nil broken-links:nil c:nil creator:nil
#+options: d:(not "LOGBOOK") date:t e:t email:nil f:t inline:t num:nil
#+options: p:nil pri:nil prop:nil stat:t tags:t tasks:("TODO" "DONE" "NEXT") tex:t
#+options: timestamp:t title:nil toc:nil todo:nil |:t
#+title: A High-Throughput Computational Dataset of Halide Perovskite Alloys\textsuperscript{\dag}
#+AUTHOR: Panayotis Manganaris
#+language: en
#+select_tags: export
#+exclude_tags: noexport
#+creator: Emacs 29.0.50 (Org mode 9.5.3)
#+cite_export:
#+latex_class: article
#+latex_class_options: [twoside, twocolumn, 9pt, draft]
#+latex_header: \usepackage[acronym,nogroupskip,nonumberlist]{glossaries}
#+latex_header: \usepackage[%
#+latex_header: stylemods,style=long-short,
#+latex_header: ]{glossaries-extra}
#+latex_header: \makeglossaries
#+latex_header_extra:
#+description:
#+keywords:
#+subtitle:
#+latex_compiler: pdflatex
#+date: \today
#+SETUPFILE: ~/org/rsc_header.org
#+INCLUDE: ./frontmatter.org

#+begin_export latex
\footnotetext{\textsuperscript{a}School of Materials Engineering, Purdue University, West Lafayette, IN 47907, USA; E-mail: amannodi@purdue.edu}
\footnotetext{\textsuperscript{\dag}Electronic Supplementary Information (ESI) available: https://www.github.com/PanayotisManganaris/REPO_TODO. See DOI: 00.0000/00000000.}
#+end_export

* DONE Introduction
:PROPERTIES:
:CUSTOM_ID: introduction
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from "TODO"       [2022-07-12 Tue 12:14]
- State "DONE"       from              [2022-06-05 Sun 18:16]
:END:
The perovskite structure has been widely investigated by material
scientists in recent decades for its promising industry
applications. A perovskite unit cell contains a generalized
three-component ABX3 formula unit wherein A and B are cations with
different oxidation states while X is an anion. The symbolic 3D
perovskite structure is a network of BX6 octahedra which are held in
place by large A-site cations. This unique structure makes the
crystal's electronic properties incredibly tunable. Numerous research
efforts are devoted to [[acrfull:hap][halide perovskites (HaP)]], specifically, as a
promising solar cell absorption material[XXX]. ABX3 [[acrlong:hap][halide perovskite]]
X-sites anions consist of halogens such as I and Br, B-site cations
may be divalent elements such as Pb and Sn, and the A-site is occupied
by large monovalent cations. The A-site cation can be so large that
either inorganic (e.g Cs, K, Rb) elements or organic ligands (e.g
[[acrfull:ma][Methylammonium (MA)]] and [[acrfull:fa][Formamidinium (FA)]]). The most commonly studied
hybrid organic-inorganic [[acrlong:hap][halide perovskites]], MAPbI3 and FAPbI3, have
relatively recently demonstrated extraordinary [[acrfull:pce][power conversion
efficiency (PCE)]] between 20% and 25% when used as absorbers in
single or multi junction solar cells[XXX]. This is a five fold
improvement over prior art and shows off the most attractive feature
of halide perovskites, their unique tunability. Experimentally, it has
been shown that a perovskite structure is considered stable if A-site,
B-site, and X-site ionic radii satisfy the well-known tolerance (t)
and octahedral (\mu) relations[XXX]. Even under these restrictions,
the configuration space of [[acrshort:hap][HaP]] structures, alloy ratios, alloy
ordering, and defects still poses a highly multidimensional
optimization problem.  Generally speaking, [[acrlong:hap][halide perovskite]] design
can be divided into several aspects.

1. Compounds: The composition of halide perovskites is the most
   critical aspect of PV performance. The recommended halide
   perovskites as PV absorber usually contains a mix of MA, FA, and Cs
   at the A-site, primarily Pb at the B-site with minor fractions of
   other divalent cations such as Sn and Ge, and I or Br at the X-site
   often with little Cl. As the researchers expanding the search into
   complex alloys, more A-site organic ligands and Group IV, Group II,
   or transition elements, which replace Pb at B site for
   environmental purpose, are discovered.[XXX] The mixing in A site
   improves the general stability to degradation, while B site and X
   site mixing are modifying the properties of band gaps and optical
   absorption.
2. Structure and phases: Besides the well-known cubic halide
   perovskites, ABX3 perovskites can also exist in tetragonal,
   orthorhombic, or hexagonal phases [XXX]. The structure can further
   change to corner-shared octahedral networks, discovered from
   evolutionary or minima hopping algorithms [XXX]. 2D layered halide
   perovskites are also a hot topic and widely researched phase for
   halide perovskites.
3. Defects: Vacancies, self-interstitials, or impurities may be
   spontaneously present within HaPs, or intentionally introduced to
   change the equilibrium conductivity [XXX]. It’s essential to halide
   perovskites to study the effects of point defects on electronic
   properties and structural stability.

As the huge number of halide perovskites compounds, it rises
challenges for experimentalists to screen over all
possibilities. However, first principles simulation, such as density
functional theory (DFT), have been systematically performed to model
each of the factors mentioned above. More importantly, the expense of
DFT modeling is much more acceptable when searching for new promising
candidates in such boundaryless space. Recently, DFT simulations are
known to be reliably applied for modeling structural information, heat
of formation or decomposition, band gaps, optical absorption spectra,
and defect formation energies of a variety of HaPs, with mixed
accuracy compared to experiments.[XXX] DFT simulation also
successfully screening a large set of hybrid and inorganic ABX3 halide
perovskites. Castelli et al [XXX] present a halide perovskite dataset
of 240 hybrid and inorganic perovskites, with Cs, MA, and FA as A-site
cations, Pb and Sn at the B-site, and some mix of Cl, Br, and I at the
X-site, in the cubic, tetragonal, and two types of orthorhombic
phases. This work investigates the formation of mixed halide compounds
and trends of band gaps, revealing the correct combination of A
cation, B cation, perovskite phase, and X-site mixing which yields a
PV-suitable band gap and good stability.

The limitation of DFT screening is the expensive cost for suitable
accurate level of theory for a huge set of data set. To better explore
the perovskite space, coupling DFT calculations with state-of-the-art
machine learning (ML) or artificial intelligence (AI) techniques is a
new direction for high throughput simulation on halide perovskite
screening. Park et al. [XXX] employed a DFT+ML approach to investigate
the inherent (dis)similarity of various chalcogenide and halide
perovskites. They used GGA-PBE calculations on 120 ABX3 compounds to
generate the dataset, and then training random forest regression model
with t, µ, and tabulated elemental properties as inputs were able to
predict band gaps and octahedral distortion, and reveal the
descriptors of most importance to each property. A reliable DFT data
set with large numbers of mixed halide perovskites will serve as great
training data for ML models and accelerate the exploring of new halide
perovskite compounds.

# The challenge of optimizing Perovskite performance is one with many
# facets. Almost every detail of a Perovskite crystal's structure and
# chemistry effects its performance as a semiconductor. The size of the
# unit cell effects its substrate affinity and in turn its carrier
# concentrations [[cite:&jiang-2006-predic-lattic]]. The crystal's phase
# effects many aspects of the electronic structure, including the band
# gap and optical response. Of course, these qualities of a structure
# are largely dependent on the specification, proportions and
# arrangements of the constituent elements.

We report a synthetic dataset collected for 495 chemically distinct,
pseudo cubic Halide Perovskites. This dataset builds on that of 229
samples which formed the foundation of the prior work by
[[citet:&mannodi-kanakkithodi-2022-data-driven]]. The [[acrfull:dft][density functional
theory (DFT)]] computed properties we collected and the levels of theory
used are discussed in [[Methodology]]. The relatively large size of this
dataset is intended to provide an initial sampling suitable for
guiding exploration of the alloy space. In this dataset, structures
are constantly pseudo-cubic, instead we focus on studying the effects
of sample composition and combinatorial alloying possibilities on the
computed properties.

This exploration is focused on analyzing data features derived from
the perovskite compositions. Composition vectors are inherently
bounded -- they have a maximum magnitude -- and they are strongly
correlate with each other in that they sweep through their bounded
domain according to the design of the experiment. There is much
difficulty in "unfolding" this hyper-geometric volume in such a way as
to reveal patterns in composition that relate to properties targeted
for prediction. 

In any data analysis, the objective is to extract patterns which
directly aid the training of a predictive model. In this interest, a
relatively small number of unique, uncorrelated, and
"influential"[[cite:&mahoney-2009-cur-matrix]] features are desirable. To
this end, we report a variety of feature engineering pipelines with an
emphasis on dimensionality reduction.

The ubiquitous [[acrfull:pca][principal component analysis (PCA)]] has been employed
for materials discovery with success. In one prominent instance, under
a very different dataset, it aided with identifying patterns relating
superconductor transition temperature with valency in ceramic
oxides[[cite:&rajan-2009-princ-compon]]. here, pca simply identifies 3 out
of 5 variables which dominate the variance in the data, thereby aiding
the formulation of a physically meaningful description of the
phenomenon.

The method of [[acrshort:pca][PCA]] is the Singular Value Decomposition, a unitary
transform which generalizes the familiar eigen decomposition.
Conceptually, [[acrshort:pca][PCA]] will "rotate" the \(N\) data points in
\(M\)-dimensional space until their widest \(k\)-dimensional cross
section is found. Naturally, the first \(k\) principal components may
be chosen by the user, but they are determined in an entirely
unsupervised, mathematical manner. So long as \(k<M\) they represent a
lossy, lower-dimensional projection of the data. Even better, they
inherently gather the major variance into a minimal number of
orthogonal axes. This makes [[acrshort:pca][PCA]] a robust and powerful feature
engineering technique for (1) constructing uncorrelated
features[[cite:&mahoney-2009-cur-matrix]] and (2) de-noising data.

For this, the study by [[citet:&rajan-2009-princ-compon]] is noteworthy
because it uses the second and third principal components in a 5
dimensional space to formulate its model. This clearly demonstrates
that meaningful patterns can emerge even in [[acrshort:pca][PCA]] cross sections that
capture less overall variance. This is something we are attentive to
in our "round" [[acrshort:pca][PCA]] space with many similarly potent principal
components (see figure label:fig:scree).

Considerably more complex data projections are also examined. Two
relatively novel dimensionality reduction techniques, namely
[[acrfull:tsne][t-distributed stochastic neighbor embedding (t-SNE)]]
[[cite:&maaten-2008-visual-high]] and [[Acrfull:umap][Uniform manifold approximation and
projection (UMAP)]] [[cite:&mcinnes-2018-umap]] are employed mainly for the
purpose of algorithmically clustering feature spaces. This is because
these methods are non-parametric, as such they transform a data space
rather than a data point. This makes it more difficult to use them as
a feature engineering method, but it is not impossible. An attempt at
enabling [[acrshort:umap][UMAP]] to be used in this way exists as an implementation of
"parametric UMAP" by [[citet:&mcinnes-2018-python-umap]] which trains a
neural network to learn a mapping between the data space and manifold
projection.

We do see the older [[acrshort:tsne][t-SNE]] method clusters [[acrshort:hap][HaP]] decomposition energies
effectively on the embedding space of composition vectors. This
quality is examined in multiple ways, but we try to recreate it with
parametric UMAP so as to create a viable feature engineering pipeline
utilizing the transformation.

#+ATTR_LATEX: :float multicolumn :options h
#+CAPTION: \label{fig:outline} 
#+CAPTION: (a) Chemical space of ABX_3 perovskites. (b) Number of samples
#+CAPTION: representing each kind of primary alloy. (c) Detailed outline.
[[file:./figs/outline.png]]

* TODO Methodology
:PROPERTIES:
:CUSTOM_ID: methodology
:CLASS: unnumbered
:END:
** NEXT Building Perovskite Dataset
:PROPERTIES:
:CUSTOM_ID: building-perovskite-dataset
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "NEXT"       from "TODO"       [2022-06-05 Sun 22:11]
:END:
The dataset we report is based on standard cubic phase ABX_3
Perovskite structures originally obtained from Computational Materials
Repository (CMR)[[cite:&pilania-2016-machin-learn]]. Fourteen common
Perovskite constituents are selected to form our Halide Perovskite
composition space (Figure ref:fig:outline). Five constituents
including [[acrshort:ma][MA]] and [[acrshort:fa][FA]] cations represent the possible A-site
occupants. Six metals represent the possible B-site occupants. Three
halides represent the possible X-site occupants. In total, these
component vectors form a constrained 14 dimensional space (Figure
ref:fig:chemspace_uni) within which all Perovskite compounds
consisting of the elements in Figure ref:fig:outline (a) must exist.

The pure (non-alloyed) possibilities are exhaustively sampled using
\(5*6*3 = 90\) Perovskites. Based on these pure Perovskite structures,
we mix candidates for A, B, and X sites systematically. The alloy
space sees combinatorial scaling and must be sparsely sampled (Figure
ref:fig:sample_map).

To generate site-mixing structures with high representativeness,
[[acrfull:sqs][special quasi-random structures (SQS)]] are applied. The [[acrshort:sqs][SQS]] method is
to build a special periodic structure and make the first
nearest-neighbor shells as similar to the target random alloy as
possible. The [[acrshort:sqs][SQS]] can be considered the best possible periodic unit
cell representing a given random alloy.

Each computational run is performed using a 2x2x2 supercell, this
allows A and B site doping to be modeled in discrete 1/8^th fractions
of the total site occupancy, and it allows X site doping to be modeled
in 1/24^th fractions. At these mixing levels, it is appropriate to
call all these Perovskites alloys.

Following this procedure, 126 A-site mixing samples, 151 B-site
mixing samples and 127 X-site mixing samples are generated. All
resulting structures are optimized using a [[acrshort:dft][DFT]] variable-cell
relaxation under [[acrfull:pbe][PBE]]. These same initial structures also underwent a
full [[acrfull:hse][HSE]] relaxation to help ensure the validity of the [[acrshort:pbe][PBE]]
relaxations, however this was only computationally tractable for 299
samples.

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:chemspace_uni}
#+CAPTION: Plots showing number of Perovskites representing a constituent
#+CAPTION: at a certain atomic fraction of a complete Perovskite.
[[file:./domains/variability_of_composition_vectors.png]]

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:sample_map}
#+CAPTION: Heatmaps show samples chosen to represent B-alloy space

** DONE Calculation Details
:PROPERTIES:
:CUSTOM_ID: calculation-details
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from "TODO"       [2022-06-06 Mon 17:17]
:END:
DFT calculations are performed with [[gls:vasp][VASP]] version 6.2. The [[acrlong:paw][projector
augmented wave]] potentials were used as pseudopotentials. The
[[acrlong:gga][generalized gradient approximation]] of [[acrshort:pbe][PBE]] and the hybrid [[acrshort:hse][HSE]]06
(\alpha=0.25 and \omega=0.2) functionals are used as
exchange-correlation energy. The energy cutoff for the plane-wave
basis is set to 500 eV. For [[acrshort:pbe][PBE]] the Brillouin zone was sampled by
6x6x6 reciprocal mesh using the Monkhorst-Pack k-point mesh. For [[acrshort:hse][HSE]]
the Brillouin zone was sampled by 2x2x2 reciprocal mesh using the
Monkhorst-Pack k-point mesh. The structural force convergence
threshold is set to be 0.005 eV/\AA.

** TODO Discussion of DFT Computed Properties
:PROPERTIES:
:CUSTOM_ID: analysis-of-dft-computed-properties
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from "TODO"       [2022-06-06 Mon 17:19]
:END:
*** DONE Decomposition Energy
:PROPERTIES:
:CUSTOM_ID: decomposition-energy
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from "TODO"       [2022-06-06 Mon 00:43]
:END:
The decomposition energy indicates the stability of a compound. To
calculate the decomposition energy for an ABX3 Perovskite, we assume
it will decompose to two phases, AX and BX2. Using [[acrshort:dft][DFT]] calculations,
we can get the optimized energy of a Perovskite and that of its
constituent phases. The decomposition energy is calculated using
equation eqref:eq:decoE. This calculation is performed separately for
each level of theory.

\begin{equation}\label{eq:decoE}
E_{decomp} = E_{opt}(ABX_3) - E_{opt}(AX) - E_{opt}(BX2)
\end{equation}

*** TODO SLME calculations
:PROPERTIES:
:CUSTOM_ID: slme-package
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from "TODO"       [2022-06-06 Mon 17:30]
:END:
The [[gls:slme][SLME]] metric developed by [[citet:&yu-2012-ident-poten]] is used as the
primary criterion screening perovskites for their photovoltaic
merits. The [[gls:slme][SLME]] value is computed considering a 5\mu{}m absorption
layer for every Perovskite according to equation eqref:eq:slme.

\begin{equation}\label{eq:slme}

\end{equation}

This calculation is performed using Logan William's SL3ME
[[cite:&williams-2022-sl3me]]. Based on absorption spectra obtained from
from [[gls:vasp][VASP]]. This calculation is performed separately for the [[acrshort:pbe][PBE]] band
gaps and the [[acrshort:hse][HSE]] band gaps, resulting in two synthetic efficiencies
for each record.

* TODO Results and discussion
:PROPERTIES:
:CUSTOM_ID: results-and-discussion
:CLASS: unnumbered
:END:
** TODO Visualization of DFT Data
:PROPERTIES:
:CUSTOM_ID: visualization-of-dft-data
:CLASS: unnumbered
:END:
#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:pairplots} 
#+CAPTION: DFT Results: PBE and HSE properties; lattice constants,
#+CAPTION: decomposition energies, band gaps, and converter efficiencies.
[[file:./figs/screening_properties.png]]

*** DONE Lattice constant PBE vs HSE
:PROPERTIES:
:CUSTOM_ID: lattice-constant-pbe-vs-hse
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from              [2022-06-06 Mon 01:02]
:END:
Fig ref:fig:lc_lot_vs presents the lattice parameter comparison of
[[acrshort:pbe][PBE]] calculation and [[acrshort:hse][HSE]]
calculations. Full relaxations at both levels of theory mostly agree
on the lattice parameters. At least, any deviation appears to be very
linearly explained. This suggests the accuracy of
[[acrshort:pbe][PBE]] relaxation is enough to optimize most Perovskite
samples.

Note this also served as a reasonable validation for our results. A
few samples did have significantly differing lattice parameters. This
prompted checking the optimized structures. We found those Perovskite
structures were substantially deformed and no longer had obvious
octahedral structures. Thus, we exclude these outliers from any
analysis concerned with the dominant pseudo cubic structures which are
the focus of this report.

#+ATTR_LATEX: :float
#+CAPTION: \label{fig:lc_lot_vs}
#+CAPTION: Comparing lattice constants obtain by full PBE and HSE
#+CAPTION: relax calculations
[[file:./expval/pbe_v_hse_LC.png]]

*** TODO Comparing synthetic to physical data
:STATUSLOG:
- State "DONE"       from              [2022-06-06 Mon 01:01]
:END:
#+ATTR_LATEX: :float 
#+CAPTION: \label{fig:lc_val_vs} 
#+CAPTION: Comparison of PBE and HSE computed pseudo-cubic lattice
#+CAPTION: constants with crystallographic measures for lattice constants
[[file:./expval/pbe_v_exp_LC.png]]
[[file:./expval/hse_v_exp_LC.png]]

The physical data used in the Lattice Constant Comparisons is
collected from the works of
[[citet:&briones-2021-accel-lattic;&jiang-2006-predic-lattic;&chen-2015-under-spotl]].

The synthetic lattice constants do mostly agree with experiment. The
[[acrshort:pbe][PBE]] lattice constants are better than the [[acrshort:hse][HSE]] measures ref:tbl:verror.

It should be noted that the physical [[acrshort:fa][FA]]SnI_3 measure reported by
[[citet:&chen-2015-under-spotl]] is clearly an orthorhombic phase. The
validating lattice constant here is obtained by averaging lattice
parameters. However, per the [[Deviation from Cubicity]] metric, this
phase is still approximately cubic, with angles near enough to 90
degrees that we consider the data point valid. However, this does
explain the disagreement in the parity plots.

#+CAPTION:\label{tbl:verror}
#+CAPTION:Root Mean Squared Error
| HSE v EXP | PBE v EXP |
|-----------+-----------|
|           |           |

*** TODO Decomposition energy vs band gap PBE and HSE
:PROPERTIES:
:CUSTOM_ID: decomposition-energy-vs-band-gap-pbe-and-hse
:CLASS: unnumbered
:END:
Fig 2(b) is showing the [[acrshort:pbe][PBE]] band gap compared to the
[[acrshort:pbe][PBE]] decomposition energy. It presents the diversity
of our Perovskite dataset. The data sets cover a large range of band
gap and decomposition energy. For example, we have Perovskite with low
decomposition energy (good stability) and suitable band gap value
(between 1 eV to 2.5 eV for [[acrshort:pbe][PBE]] calculations). And
we can also find samples with low stability and large band gap. The
distribution of band gap and decomposition energy shows a great
diversity of all Perovskite samples and indicates that our data set
can statistically represent a sufficient Perovskite space. Fig 2(c)
shows the plot of [[acrshort:pbe][PBE]] band gaps and
[[acrshort:hse][HSE]] decomposition energy. Since we applied
[[acrshort:hse][HSE]] calculations for part of the samples, it shows
some grouping on low decomposition energy. Compared to
[[acrshort:pbe][PBE]] plot, more data should be added in high
decomposition energy region and suitable band gap region.

*** TODO Spectroscopic Limited Maximum Efficiency (SLME) vs PBE Band gap
:PROPERTIES:
:CUSTOM_ID: spectroscopic-limited-maximum-efficiency-slme-vs-pbe-band-gap
:CLASS: unnumbered
:END:
Fig 2(d) presents the [[gls:slme][SLME]] values related to the
[[acrshort:pbe][PBE]] band gap. [[gls:slme][SLME]] is a proven proxy
for photovoltaic performance
[[cite:&yu-2012-ident-poten]]. [[gls:slme][SLME]] measures the
absorption efficiency of light for the Perovskite. As Fig 2(d)
showing, a peak around 1.5 eV is obvious. The peak indicates that
these samples with 1.5 eV [[acrshort:pbe][PBE]] band gap will also
have best absorption efficiency as photovoltaic materials. As the band
gap increases, the [[gls:slme][SLME]] value decreases and eventually
goes to zero due to the high band gap values.

** TODO Pearson Correlation Results
:PROPERTIES:
:CUSTOM_ID: pearson-correlation-results
:CLASS: unnumbered
:END:

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:pearson_pcomp}
#+CAPTION: Pearson linear correlation coefficients between 14 composition variables,
#+CAPTION: and 4 PBE computed properties
[[file:./expval/PBE_v_comp_pearson2.png]]

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:pearson_psite}
#+CAPTION: Pearson linear correlation coefficients between 36 elemental descriptors
#+CAPTION: and 4 PBE computed properties
[[file:./expval/PBE_v_site_prop_pearson.png]]

No target is adequately explained by a single composition or
composition derived axis. But there are helpful relations that aid
understanding the significance of key composition derived descriptors.

A Pearson correlation map is produced to check for strong
relations. Those that exist, when plotted in detail show some
trending, but always with extensive variability. Evidently, an
accurate model will have to be formed on a multidimensional domain.

** TODO PCA
:PROPERTIES:
:CUSTOM_ID: pca
:CLASS: unnumbered
:END:

#+ATTR_LATEX: :float multicolumn :options h
#+CAPTION: \label{fig:scree} 
#+CAPTION: The ratios of variance explained by each principal component 
#+CAPTION: obtained by a full SVD decomposition.


#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:pca}
#+CAPTION: PCA
[[file:./multivar/comp_ratio_projection_annot.png]]


However, in a homogeneous domain of the sort outlined by the ABX3
perovskite, pca is most effective only for identifying the major
topology of the data distribution. While this tends to involve
uninformative biases in a regression, it is still useful for revealing
global trends in the explored space.

 however, these variables are unsurprising
and may not as strongly explain the properties targeted for
statistical modeling


[[acrshort:pca][PCA]] is a method of projecting high dimensional data onto
a plane defined by the two linear combinations of axes that explain as
much of the variance as possible.


At this point it is readily apparent that this dataset is highly
topological. The data exists on a mostly bounded domain in high
dimensions, so there is some geometry the features constitute.

Our models will prefer to use this this geometric structure in their
explanation for why Perovskite properties vary, this can be useful for
accuracy, it can also be a bias-inducing hindrance.

** TODO t-SNE visualization of stability clustering
:PROPERTIES:
:CUSTOM_ID: mds-t-sne-isomap-results
:CLASS: unnumbered
:END:
#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:tsne}
#+CAPTION: t-SNE 
[[file:./multivar/tsne_comp_DecoE_clusters.png]]

** DONE Screening process of all samples in database
:PROPERTIES:
:CUSTOM_ID: screening-process-of-all-samples-in-database
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from              [2022-05-24 Tue 13:31]
:END:
The synthetic Perovskite data is collected for sampling variety and
without regard for each compound's viability. In order to extract
potentially high-performing candidates for synthesis, we screen all
samples according to certain constraints, thereby obtaining some
Perovskites worth examining with higher Level of Theory
[[acrshort:dft][DFT]] calculations and future physical experiments by
brute force. This dataset can only confidently claim to sample cubic
phase perovskites. Therefore, a promising candidate should have low
deformation. Additionally, a lower decomposition energy combined with
a maximal [[gls:slme][SLME]] value would be ideal for physical
testing. Our screening procedure consists of cutting based on a custom
Deviation from Cubicity metric, octahedral factor, Goldschmidt
tolerance factor, Bartel tolerance factor, decomposition energy, and
band gap -- acting as less stringent proxy for the [[gls:slme][SLME]]
spectrum. The following sections will discuss the details of each
constraint.

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:cuts}
#+CAPTION: Screening results of Decomposition Energy for (a) octahedral factor
#+CAPTION: (b) Tolerance Factor (c) Bartel Tolerance Factor (d) Deviation of
#+CAPTION: Cubicity.
[[file:./figs/screening_factor.png]]

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:leftover}
#+CAPTION: 49 Screened perovskites analysis, (a) pie chart of element
#+CAPTION: distribution, (b) pie chart of site mixing
[[file:./figs/screening_pie.png]]

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:leftover_comp}
#+CAPTION: Plots of element fraction for A, B, X sites of all screened perovskites.
[[file:./figs/Element_Frac.png]]

*** TODO Deviation from Cubicity
:PROPERTIES:
:CUSTOM_ID: deviation-of-cubicity
:CLASS: unnumbered
:END:
For all the compositions we tested in our data set, some of them will
have large strain and deformation because of the combination of
elements. For these largely deformed samples, they are no longer
remain a cubic perovskite structure. In this section, we want to
analyst how the structure is apart from the cubic perovskite structure
and rule out these largely deformed samples. Firstly, we need to
define deviation of cubicity. For each perovskite sample, we measure
the difference between b, c lattice parameter against a lattice,
showing in Equation X. If the lattice deviation of cubicity is larger
than 10%, we will consider this perovskite is no longer remain a cubic
perovskite and exclude it.  Similarly, we also need to consider 3
angles, , and , to make sure the angle also remain 90 degrees. We
calculated the difference of , and versus 90 degrees, showing in
Equation X, and take this as angular deviation of cubicity. We also
consider the samples that have more than 5% of angular deviation of
cubicity are not cubic perovskites and exclude them. Fig 7 (d) shows
the screening results for angle deviation of cubicity. SI Fig X shows
the screening results for b, c lattice and , angle. Most of the
samples with non-cubic perovskites structures are organic-inorganic
hybrid perovskites. A large part of the excluded samples are A-mixing
hybrid perovskites. It indicates that organic ligands in A site
sometimes increase the lattice along some direction and make the
perovskite deformed.

*** TODO Octahedral factor, tolerance factor, and Bartel tolerance factor
:PROPERTIES:
:CUSTOM_ID: octahedral-factor-tolerance-factor-and-bartel-tolerance-factor
:CLASS: unnumbered
:END:
The stability of Perovskite can be predicted by using the atom radius
of all components. There are 3 types of factors are usually
considered, Octahedral factor, tolerance factor, and Bartel tolerance
factor. The formula of these three factors are shown in equation
XXX. In our screening process, we set the criteria for Octahedral
factor as 0.442 -- 0.895. The criteria for tolerance factor is set to
be 0.813 -- 1.107.  The criteria for Bartel tolerance factor is set to
be less than 4.18.  Fig 7 (a) shows the Octahedral factor versus
decomposition energy plot.  Fig 7 (b) shows the tolerance factor
versus decomposition energy plot.  The tolerance factor shows a trend
that as the tolerance factor increases, the decomposition energy
decreases. Fig 7 (c) shows the Bartel tolerance factor versus
decomposition energy plot. Within the criteria of Bartel tolerance
factor, the decomposition energy is rapidly decreased.

*** TODO Screening Results
:PROPERTIES:
:CUSTOM_ID: screening-results
:CLASS: unnumbered
:END:
The table XXX shows all 41 promising candidates we screened from our
dataset by using the cutoff criteria mentioned above. FigXXX shows the
element distribution of all decent samples. It indicates that MA and
FA are the most common A site choices for a Perovskite with great
stability and suitable band gap and photovoltaic properties. For
inorganic A sites, Cs also contributes a large portion. In B site
element selection, Pb and Sn are the most selected than other B site
elements. For X site halide elements, Br is appears the most, and I is
the second. It tells us that Br and I are preferred in a stable
Perovskite structure. In figure XXX, the mixing distribution indicates
that X-site mixing is more favorable to generate a stable Perovskite
with required properties. Tuning in A sites and B sites can also lead
to a promising results but more risky.  The FigXXX and SI FIGXXX shows
the element fraction for each of the screened samples. It indicates if
certain element prefer to be mixing or non-mixing. For example, Cl is
preferred to be pure in X site than mixing with other elements. Also
there is some elements that only appears in pure case, for instance Sr
at B site. We can also learn from the result that elements, like K,
Cs, Cl and Ba, are more preferred to have small fraction if they are
mixing with other elements. Popular choice, like Pb and Sn, are very
flexible in element fraction. These elements can have a variety of
possible fraction in promising Perovskite samples.  The screening
results is showing the trends of how the combinations of elements are
selected and what mixing features are preferred in decent Perovskite
structures. It will also provide great help on design new Perovskite
compounds and tell us what kinds of compounds we should put in to test
next.
 
* TODO Perspective and Future Work
:PROPERTIES:
:CUSTOM_ID: perspective-and-future-work
:CLASS: unnumbered
:END:
The high-throughput DFT Perovskite dataset is containing huge amount of
information of perovskites compounds, structure and properties. It
leads us to perform screening, clustering and other process so that
lots of trends are revealed. However, there are still many
improvements we are eager to accomplish in the future.

Firstly, the dataset are generally constructed based on cubic
perovskites structures. But not all perovskites are remaining cubic as
their most stable phases. In the future, we are going to expand our
dataset that will include high-throughput DFT calculations for multiple
phases of perovskites, for example tetragonal, orthorhombic, and
hexagonal phases. This will tells us which phase we should choose for
each compound and provide more information for analysis.

Also the level of DFT functional should also be included in the future
work. Important corrections, like Van der Waals forces, spin orbital
coupling, should also be considered for different compound. We are
going to expand the dataset with information of multiple level of DFT
functional and corrections, which will eventually lead us to decide the
best suitable functional for each compounds and get more accurate
prediction.

Structural information is another critical part for tuning the
properties of Perovskite. Octahedral distortion and rotation is the
main part that causes the change in Perovskite structures. We have
ongoing work to reveal the relationship between octahedral information
and properties. These part of information will also be include in the
future dataset.

The design of this dataset is uniquely suited to the exploration of
alloying effects on Perovskite properties. The combinatorial space of
possible alloys has been sparsely but systematically sampled along
four primary alloy schemes. This sample space affords the opportunity
for a [[gls:qmml][QM/ML]] surrogate model to form the basis of an
active learning strategy which can begin selecting potentially high
performing multi-site alloy candidates based on the current sample
set.

For the calculation of future data points obtained by a surrogate
optimizer, we will follow a strategy of performing full structural
optimization at a [[acrshort:pbe][PBE]] level of theory unless circumstances demand
otherwise. This is justified by Figure ref:fig:lc_lot_vs and the
section [[Comparing synthetic to physical data]]

Also, we will explore methods for combining the insights of the [[acrshort:pbe][PBE]]
and [[acrshort:hse][HSE]] datasets in training surrogates, e.g. in section [[SLME
calculations]] the two [[gls:slme][SLME]] spectra could be used together to converge
on a physically accurate [[acrshort:pce][PCE]] value.

We anticipate our principal challenge will be in extracting useful
predictor variables from the composition information. The basic
feature sets examined here are highly correlated, but nonetheless show
promise both as a basic screening criterion, and as good classifier
features under [[gls:tsne][t-SNE]] transformation.

Modeling pipelines capable of predicting Perovskite decomposition
energy will likely be very achievable using a transduction and
invertible equivalent of the [[gls:tsne][t-SNE]] algorithm,
potentially SONG.

For this reason, kernel learning methods appear to be particularly
promising for high speed optimization of the space.

* DONE Conclusions
:PROPERTIES:
:CUSTOM_ID: conclusions
:CLASS: unnumbered
:END:
:STATUSLOG:
- State "DONE"       from "TODO"       [2022-07-12 Tue 12:14]
:END:
In this work, we present a DFT calculated perovskite data set with 495
pseudo-cubic perovskite samples with A-site, B-site and X-site
mixing. The mixing arrangements are built using SQS methods. All
perovskite structures are optimized by GGA-PBE calculations and
furthermore, 299 samples are also relaxed by HSE06
functional. Validating the efficacy of both relaxation methods against
experimentally determined structures shows that, conveniently, PBE-GGA
is more effective for determining the pseudo-cubic lattice
constant. Both PBE and HSE functionals are not very effective at
predicting band gaps. In addition, we analyze trends in stability and
various electronic properties and optical properties by identifying
linear correlations and utilizing clustering methods. These analyses
show promise for using compositional properties alone to predict
perovskite stability by predicting decomposition energy. Finally,
screening on derived factors and predicted targets is also used to
filter the 495 perovskite data set down to some promising perovskite
candidates with high stability and suitable electronic and optical
properties. This data set will be used in the future to train
statistical models and inform inverse design pipelines.

* Conflicts of Interest
:PROPERTIES:
:CUSTOM_ID: conflicts-of-interest
:CLASS: unnumbered
:END:
There are no conflicts to declare.

* Acknowledgements
:PROPERTIES:
:CUSTOM_ID: acknowledgements
:CLASS: unnumbered
:END:
Extensive discussions with and scientific feedback from UC San Diego
researchers David Fenning and Rishi Kumar and Argonne National Lab
scientist Maria Chan are acknowledged. This work was performed at
Purdue University, under startup account F.10023800.05.002 from the
Materials Engineering department. This research used resources of the
National Energy Research Scientific Computing Center, the Laboratory
Computing Resource Center at Argonne National Laboratory, and the RCAC
clusters at Purdue.

bibliographystyle:rsc
bibliography:~/org/bibliotex/bibliotex.bib
bibliography:./main.bib
* Supplemental Material
:PROPERTIES:
:CUSTOM_ID: SI
:CLASS: unnumbered
:END:

[[printglossaries:]]

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:pearson_hcomp}
#+CAPTION: Pearson linear correlation coefficients between 14 composition variables,
#+CAPTION: and 4 HSE computed properties
[[file:./expval/HSE_v_comp_pearson2.png]]

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:pearson_hsite}
#+CAPTION: Pearson linear correlation coefficients between 36 composition variables,
#+CAPTION: and 4 HSE computed properties
[[file:./expval/HSE_v_site_prop_pearson.png]]

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:sreened_frac_A}
#+CAPTION: Element Fraction for A site elements among all screened perovskites
file:./expval/Element_AFrac.jpg

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:sreened_frac_B}
#+CAPTION: Element Fraction for B site elements among all screened perovskites
[[file:./expval/Element_BFrac.jpg]]

#+ATTR_LATEX: :float multicolumn
#+CAPTION: \label{fig:sreened_frac_X}
#+CAPTION: Element Fraction for X site elements among all screened perovskites
[[file:./expval/Element_XFrac.jpg]]


#+name: glossary
| label | term  | definition                                    |
|-------+-------+-----------------------------------------------|
| vasp  | VASP  | Vienna Ab initio Simulation Package           |
| slme  | SLME  | spectroscopic limited maximum efficiency      |
| qmml  | QM/ML | quantum mechanics machine learning            |

#+name: acronyms
| label | abbreviation | full form                                     |
|-------+--------------+-----------------------------------------------|
| dft   | DFT          | density functional theory                     |
| sqs   | SQS          | special quasi-random structures               |
| paw   | PAW          | projector augmented wave                      |
| gga   | GGA          | generalized gradient approximation            |
| pbe   | PBE          | Perdew-Burke-Ernzerhof                        |
| hse   | HSE          | Heyd-Scuseria-Ernzerhof                       |
| ma    | MA           | Methylammonium                                |
| fa    | FA           | Formamidinium                                 |
| pce   | PCE          | power conversion efficiency                   |
| hap   | HaP          | halide perovskite                             |
| pca   | PCA          | principal component analysis                  |
| tsne  | t-SNE        | t-distributed stochastic neighbor embedding   |
| umap  | UMAP         | uniform manifold approximation and projection |
